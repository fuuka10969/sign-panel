(function(t){function e(e){for(var n,o,r=e[0],l=e[1],h=e[2],u=0,d=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&d.push(s[o][0]),s[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);c&&c(e);while(d.length)d.shift()();return a.push.apply(a,h||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],n=!0,r=1;r<i.length;r++){var l=i[r];0!==s[l]&&(n=!1)}n&&(a.splice(e--,1),t=o(o.s=i[0]))}return t}var n={},s={index:0},a=[];function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/sign-panel/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var h=0;h<r.length;h++)e(r[h]);var c=l;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("c31f")},"417b":function(t,e,i){"use strict";i("75b1")},"5e45":function(t,e,i){},"75b1":function(t,e,i){},c31f:function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("f751"),i("097d");var n=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("div",{staticClass:"tips"},[t._v("温馨提示：请使用正楷在框内签署您的名字，注意字迹工整。")]),i("div",{staticClass:"text-list"},t._l(t.nameList,(function(e,n){return i("div",{key:n,class:["text-item",{"is-active":t.activeIndex===n}]},[t._v("\n      "+t._s(e)+"\n    ")])})),0),i("sign-panel",{ref:"signPanel",staticClass:"sign-canvas",attrs:{signText:t.nameList[t.activeIndex],lastWriteSpeed:4},on:{confirm:t.handleCompare}}),i("div",{staticClass:"confirm-text"},[t._v("已输入文字")]),i("div",{staticClass:"view-list"},t._l(t.imgList,(function(t,e){return i("img",{key:e,staticClass:"view-image",attrs:{src:t,width:"150",height:"150"}})})),0),i("div",{staticClass:"button-footer"},[i("button",{staticClass:"button",on:{click:function(e){return t.canvasClear()}}},[t._v("清空")]),i("button",{staticClass:"button button-primary",class:{"is-disabled":!t.signDone},attrs:{disabled:!t.signDone},on:{click:function(e){return t.submitImg()}}},[t._v("提交")])])],1)},a=[],o=(i("7f7f"),i("28a5"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sign-panel"},[i("canvas",{ref:t.bgId,staticClass:"sign-canvas-bg",style:t.showBorder&&{border:t.borderWidth+"px solid "+t.borderColor},attrs:{id:t.bgId}}),i("canvas",{ref:t.domId,staticClass:"sign-canvas",attrs:{id:t.domId},on:{mousedown:function(e){return e.preventDefault(),e.stopPropagation(),t.handleMousedown.apply(null,arguments)},mousemove:function(e){return e.preventDefault(),e.stopPropagation(),t.handleMousemove.apply(null,arguments)},mouseup:function(e){return e.preventDefault(),e.stopPropagation(),t.handleMouseup.apply(null,arguments)},mouseleave:function(e){return e.preventDefault(),e.stopPropagation(),t.handleMouseleave.apply(null,arguments)},touchstart:function(e){return e.preventDefault(),e.stopPropagation(),t.handleTouchstart.apply(null,arguments)},touchmove:function(e){return e.preventDefault(),e.stopPropagation(),t.handleTouchmove.apply(null,arguments)},touchend:function(e){return e.preventDefault(),e.stopPropagation(),t.handleTouchend.apply(null,arguments)}}},[t._v("\n      您的浏览器不支持canvas技术,请升级浏览器!\n  ")])])}),r=[],l=(i("6b54"),i("c5f6"),{name:"SignPanel",model:{value:"image",event:"confirm"},props:{image:{required:!1,type:[String],default:null},width:{type:Number,default:360},height:{type:Number,default:360},bgColor:{type:String,default:"#fff"},showBorder:{type:Boolean,default:!0},borderWidth:{type:Number,default:1},borderColor:{type:String,default:"#ccc"},signText:{type:String},showBgText:{type:Boolean,default:!0},bgTextSize:{type:Number,default:240},writeWidth:{type:Number,default:4},maxWriteWidth:{type:Number,default:30},minWriteWidth:{type:Number,default:4},color:{type:String,default:"#101010"},lineCap:{type:String,default:"round"},lineJoin:{type:String,default:"round"},isSign:{type:Boolean,default:!1},imgType:{type:String,default:"png"},autoWriteDone:{type:Boolean,default:!0},doneTime:{type:Number,default:1500},isDpr:{type:Boolean,default:!1},isFullScreen:{type:Boolean,default:!1},isFullCover:{type:Boolean,default:!1}},data:function(){return{value:null,domId:"sign-canvas-".concat(Math.random().toString(36).substr(2)),bgId:"sign-canvas-bg-".concat(Math.random().toString(36).substr(2)),canvas:null,context:null,dpr:1,writeDoneTimer:null,resizeTimer:null}},mounted:function(){this.init(),window.addEventListener("resize",this.resizeCanvasInit,!0)},methods:{resizeCanvasInit:function(){var t=this;this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout((function(){t.init()}),1e3)},init:function(){this.dpr="undefined"!==typeof window&&this.isDpr&&(window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio)||1,this.canvas=document.getElementById(this.domId),this.canvasBg=document.getElementById(this.bgId),this.context=this.canvas.getContext("2d"),this.contextBg=this.canvasBg.getContext("2d"),this.canvasBg.style.background=this.bgColor,this.canvasInit(this.canvas),this.canvasInit(this.canvasBg),this.canvasClear()},setCanvasSize:function(t){this.isFullScreen&&(this.width=window.innerWidth||document.body.clientWidth,this.height=window.innerHeight||document.body.clientHeight,this.isFullCover&&(t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.margin=0,t.style.zIndex=20001)),t.height=this.width,t.width=this.height},canvasInit:function(t){var e=this.dpr;t.width=this.width*e,t.height=this.height*e,t.style.width="".concat(this.width,"px"),t.style.height="".concat(this.height,"px"),this.emptyCanvas=t.toDataURL("image/".concat(this.imgType))},canvasClear:function(){this.autoWriteDone&&this.writeDoneTimer&&clearTimeout(this.writeDoneTimer);var t=this.context,e=this.contextBg;t.save(),e.save(),t.strokeStyle=this.color,t.clearRect(0,0,this.canvas.width,this.canvas.height),e.clearRect(0,0,this.canvas.width,this.canvas.height),t.beginPath(),e.beginPath(),this.showBorder&&!this.isSign&&this.setBgLineDash(this.canvasBg,e),this.showBgText&&this.signText&&this.setShowSignText(e),e.restore(),t.restore()},setBgLineDash:function(t,e){var i=t.width,n=t.height;e.lineWidth=this.borderWidth*this.dpr,e.strokeStyle=this.borderColor,e.setLineDash([8,8]),e.moveTo(0,0),e.lineTo(i,n),e.stroke(),e.moveTo(i,0),e.lineTo(0,n),e.stroke(),e.moveTo(i,0),e.lineTo(0,n),e.stroke(),e.moveTo(i/2,0),e.lineTo(i/2,n),e.stroke(),e.moveTo(0,n/2),e.lineTo(i,n/2),e.stroke()},setShowSignText:function(t){var e=this.width,i=this.height,n=this.bgTextSize;t.font="".concat(n,"px sans-serif"),t.textBaseline="middle",t.fillStyle="rgba(0, 0, 0, 0.1)";var s=(e-n)/2,a=i/2+20,o=e-(e-n)/2;t.fillText(this.signText,s,a,o)},setLineWidth:function(){var t=this.context,e=this.dpr,i=(new Date).getTime(),n=i-this.lastWriteTime;this.lastWriteTime=i;var s=this.minWriteWidth+(this.maxWriteWidth-this.minWriteWidth)*n/30;if(s<this.minWriteWidth?s=this.minWriteWidth:s>this.maxWriteWidth&&(s=this.maxWriteWidth),s=s.toFixed(2),this.isSign)t.lineWidth=this.writeWidth*e;else{var a=this.writeWidth=this.writeWidth/4*3+s/4;t.lineWidth=a*e}},writeBegin:function(t){this.autoWriteDone&&this.writeDoneTimer&&clearTimeout(this.writeDoneTimer),this.signText&&(this.isWrite=!0,this.lastWriteTime=(new Date).getTime(),this.lastPoint=t,this.writeContextStyle())},writing:function(t){var e=this.context,i=this.dpr;e.beginPath(),e.moveTo(this.lastPoint.x*i,this.lastPoint.y*i),e.lineTo(t.x*i,t.y*i),this.setLineWidth(),e.stroke(),this.lastPoint=t,e.closePath()},writeEnd:function(t){var e=this;this.isWrite=!1,this.lastPoint=t,this.autoWriteDone&&(this.writeDoneTimer=setTimeout((function(){var t=e.saveAsImg();e.$emit("confirm",t)}),this.doneTime))},writeContextStyle:function(){this.context.beginPath(),this.context.strokeStyle=this.color,this.context.lineCap=this.lineCap,this.context.lineJoin=this.lineJoin},saveAsImg:function(){var t=new Image;return t.src=this.canvas.toDataURL("image/".concat(this.imgType)),this.canvasInit(this.canvas),this.canvasInit(this.canvasBg),this.canvasClear(),t.src},handleMousedown:function(t){this.writeBegin({x:t.offsetX||t.clientX,y:t.offsetY||t.clientY})},handleMousemove:function(t){this.isWrite&&this.writing({x:t.offsetX,y:t.offsetY})},handleMouseup:function(t){this.writeEnd({x:t.offsetX,y:t.offsetY})},handleMouseleave:function(t){this.isWrite=!1,this.lastPoint={x:t.offsetX,y:t.offsetY}},handleTouchstart:function(t){var e=t.targetTouches[0],i=e.clientX?e.clientX-this.getRect().left:e.pageX-this.offset(e.target,"left"),n=e.clientY?e.clientY-this.getRect().top:e.pageY-this.offset(e.target,"top");this.writeBegin({x:i,y:n})},handleTouchmove:function(t){var e=t.targetTouches[0],i=e.clientX?e.clientX-this.getRect().left:e.pageX-this.offset(e.target,"left"),n=e.clientY?e.clientY-this.getRect().top:e.pageY-this.offset(e.target,"top");this.isWrite&&this.writing({x:i,y:n})},handleTouchend:function(t){var e=t.targetTouches,i=t.changedTouches,n=e&&e.length&&e[0]||i&&i.length&&i[0],s=n.clientX?n.clientX-this.getRect().left:n.pageX-this.offset(n.target,"left"),a=n.clientY?n.clientY-this.getRect().top:n.pageY-this.offset(n.target,"top");this.writeEnd({x:s,y:a})},downloadImg:function(t){var e=document.getElementById(this.domId),i=e.toDataURL("image/png");this.saveFile(i,t?"".concat(t,".").concat(this.imgType):"".concat(Date.parse(new Date),".").concat(this.imgType))},saveFile:function(t,e){var i=document.createElementNS("http://www.w3.org/1999/xhtml","a");i.href=t,i.download=e;var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(n)},getRect:function(){return this.$refs[this.domId].getBoundingClientRect()},offset:function(t,e){var i="offset"+e[0].toUpperCase()+e.substring(1),n=t[i],s=t.offsetParent;while(null!=s)n+=s[i],s=s.offsetParent;return n},dealImage:function(){var t=document.createElement("canvas"),e=t.getContext("2d"),i=300,n=200;t.width=i,t.width=n;var s=document.getElementById(this.domId),a=s.toDataURL("image/png");e.clearRect(0,0,t.width,t.height),e.drawImage(a,0,0,t.width,t.height)}},destroyed:function(){window.removeEventListener("resize",this.resizeCanvasInit,!0)}}),h=l,c=(i("417b"),i("2877")),u=Object(c["a"])(h,o,r,!1,null,"c595deda",null),d=u.exports;d.install=function(t){t.component(d.name,d)};var f=d,g={components:{SignPanel:f},data:function(){return{name:"熊学江",nameList:[],imgList:[],activeIndex:0,signDone:!1}},created:function(){this.init()},methods:{init:function(){this.nameList=this.name.split("")},canvasClear:function(){this.$refs.signPanel.canvasClear(),this.imgList=[],this.activeIndex=0},submitImg:function(){},handleCompare:function(t){var e=this;t&&this.imgList.length<this.nameList.length&&setTimeout((function(){var i={aiVerifyTaskId:e.taskId,verifyResult:!0,taskResult:"success"};i.verifyResult?(e.imgList.push(t),e.activeIndex+=1,e.imgList.length===e.nameList.length&&(e.signDone=!0)):alert("未能识别您的签名内容<br>请使用正楷字体重新签署")}),100)}}},p=g,v=(i("e780"),Object(c["a"])(p,s,a,!1,null,null,null)),m=v.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(m)}}).$mount("#app")},e780:function(t,e,i){"use strict";i("5e45")}});
//# sourceMappingURL=index.90ad2857.js.map